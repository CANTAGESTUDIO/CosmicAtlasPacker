# Interaction Sequence Diagrams - CosmicAtlasPacker

> 핵심 인터랙션 시퀀스 다이어그램
> **Last Updated**: 2025-12-22

---

## 목차

1. [소스 이미지 로드 및 표시](#1-소스-이미지-로드-및-표시)
2. [그리드 슬라이싱](#2-그리드-슬라이싱)
3. [자동 슬라이싱 (투명도 기반)](#3-자동-슬라이싱-투명도-기반)
4. [수동 Rectangle 슬라이싱](#4-수동-rectangle-슬라이싱)
5. [스프라이트 선택 및 속성 편집](#5-스프라이트-선택-및-속성-편집)
6. [ID 편집 및 실시간 검증](#6-id-편집-및-실시간-검증)
7. [피봇 설정 (MVP)](#7-피봇-설정-mvp)
8. [아틀라스 내보내기](#8-아틀라스-내보내기)
9. [프로젝트 저장/로드](#9-프로젝트-저장로드)
10. [애니메이션 시퀀스 편집 (Phase 3)](#10-애니메이션-시퀀스-편집-phase-3)

---

## 1. 소스 이미지 로드 및 표시

```
┌──────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │   Menu   │  │FilePicker│  │ImageUtils│  │SourcePanel│
└──┬───┘  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │              │             │             │
   │ File →    │              │             │             │
   │ Import... │              │             │             │
   │──────────→│              │             │             │
   │           │ showPicker() │             │             │
   │           │─────────────→│             │             │
   │           │              │             │             │
   │           │  selectFile  │             │             │
   │           │  Dialog      │             │             │
   │  선택     │◄─ ─ ─ ─ ─ ─ ─│             │             │
   │──────────→│              │             │             │
   │           │  filePath    │             │             │
   │           │← ─ ─ ─ ─ ─ ─ │             │             │
   │           │              │             │             │
   │           │ loadImage(path)             │             │
   │           │────────────────────────────→│             │
   │           │              │              │             │
   │           │              │  [Validate   │             │
   │           │              │   PNG Format]│             │
   │           │              │              │             │
   │           │              │  [Decode     │             │
   │           │              │   Image]     │             │
   │           │              │              │             │
   │           │         ui.Image             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │             │
   │           │              │              │             │
   │           │ updateSourceImage(image)    │             │
   │           │────────────────────────────────────────→  │
   │           │              │              │             │
   │           │              │              │ [Render     │
   │           │              │              │  Image]     │
   │           │              │              │             │
   │  화면     │              │              │             │
   │  업데이트 │              │              │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │
   │           │              │              │             │
   ↓           ↓              ↓              ↓             ↓
```

### 에러 처리 시퀀스

```
┌──────┐  ┌──────────┐  ┌──────────┐
│ User │  │   Menu   │  │ImageUtils│
└──┬───┘  └────┬─────┘  └────┬─────┘
   │           │              │
   │ 파일 선택  │              │
   │──────────→│ loadImage()  │
   │           │─────────────→│
   │           │              │
   │           │              X [Decode Fail]
   │           │    Error     │
   │           │◄─ ─ ─ ─ ─ ─ ─│
   │           │              │
   │  에러     │              │
   │  다이얼로그│              │
   │◄─ ─ ─ ─ ─ │              │
   │  표시     │              │
   │           │              │
   ↓           ↓              ↓
```

---

## 2. 그리드 슬라이싱

```
┌──────┐  ┌─────────┐  ┌────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │ Toolbar │  │ Dialog │  │  Slicer  │  │  Project │  │AtlasPreview│
└──┬───┘  └────┬────┘  └───┬────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │            │            │             │             │
   │ Grid Tool │            │            │             │             │
   │  클릭     │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │ showDialog │            │             │             │
   │           │───────────→│            │             │             │
   │           │            │            │             │             │
   │  다이얼로그│            │            │             │             │
   │  표시     │            │            │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │            │             │             │
   │           │            │            │             │             │
   │  설정 입력│            │            │             │             │
   │  - Cell  │            │            │             │             │
   │    Size  │            │            │             │             │
   │  - Offset│            │            │             │             │
   │──────────→│            │            │             │             │
   │           │            │            │             │             │
   │  Apply    │            │            │             │             │
   │  클릭     │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │ getSettings│            │             │             │
   │           │───────────→│            │             │             │
   │           │  settings  │            │             │             │
   │           │◄─ ─ ─ ─ ─ ─│            │             │             │
   │           │            │            │             │             │
   │           │ gridSliceByCellSize()   │             │             │
   │           │────────────────────────→│             │             │
   │           │            │            │             │             │
   │           │            │  [Calculate│             │             │
   │           │            │   Grid]    │             │             │
   │           │            │            │             │             │
   │           │            │  [Generate │             │             │
   │           │            │   Rects]   │             │             │
   │           │            │            │             │             │
   │           │       List<Rect>        │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │             │             │
   │           │            │            │             │             │
   │           │ createSprites(rects)    │             │             │
   │           │────────────────────────────────────→  │             │
   │           │            │            │             │             │
   │           │            │            │  [Generate  │             │
   │           │            │            │   IDs:      │             │
   │           │            │            │   sprite_0, │             │
   │           │            │            │   sprite_1] │             │
   │           │            │            │             │             │
   │           │            │            │  [Update    │             │
   │           │            │            │   State]    │             │
   │           │            │            │             │             │
   │           │        success          │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │
   │           │            │            │             │             │
   │           │ triggerRepack()         │             │             │
   │           │────────────────────────────────────────────────────→│
   │           │            │            │             │             │
   │           │            │            │             │  [Bin      │
   │           │            │            │             │   Packing]  │
   │           │            │            │             │             │
   │  UI       │            │            │             │             │
   │  업데이트 │            │            │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │
   │  - Source│            │            │             │             │
   │    Grid  │            │            │             │             │
   │  - Sprite│            │            │             │             │
   │    List  │            │            │             │             │
   │  - Atlas │            │            │             │             │
   │           │            │            │             │             │
   ↓           ↓            ↓            ↓             ↓             ↓
```

---

## 3. 자동 슬라이싱 (투명도 기반)

```
┌──────┐  ┌─────────┐  ┌────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │ Toolbar │  │ Dialog │  │  Slicer  │  │  Project │  │ ToolState│
└──┬───┘  └────┬────┘  └───┬────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │            │            │             │             │
   │ Auto Tool │            │            │             │             │
   │  클릭     │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │ showDialog │            │             │             │
   │           │───────────→│            │             │             │
   │           │            │            │             │             │
   │  설정     │            │            │             │             │
   │  - Alpha  │            │            │             │             │
   │    Threshold           │            │             │             │
   │  - Min Size            │            │             │             │
   │──────────→│            │            │             │             │
   │           │            │            │             │             │
   │  Apply    │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │ autoSlice()│            │             │             │
   │           │────────────────────────→│             │             │
   │           │            │            │             │             │
   │           │            │  [Extract  │             │             │
   │           │            │   Alpha    │             │             │
   │           │            │   Channel] │             │             │
   │           │            │            │             │             │
   │           │            │  [Binary   │             │             │
   │           │            │   Map]     │             │             │
   │           │            │            │             │             │
   │           │            │  [Flood    │             │             │
   │           │            │   Fill     │             │             │
   │           │            │   각 영역]  │             │             │
   │           │            │            │             │             │
   │           │            │  [Calculate│             │             │
   │           │            │   Bounds]  │             │             │
   │           │            │            │             │             │
   │           │            │  [Filter   │             │             │
   │           │            │   Min Size]│             │             │
   │           │            │            │             │             │
   │           │       List<Rect>        │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │             │             │
   │           │            │            │             │             │
   │           │ createSprites(rects)    │             │             │
   │           │────────────────────────────────────→  │             │
   │           │            │            │             │             │
   │           │        success          │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │
   │           │            │            │             │             │
   │           │ setActiveTool(Select) ◄─── 개선: 자동 전환!         │
   │           │────────────────────────────────────────────────────→│
   │           │            │            │             │             │
   │  UI       │            │            │             │             │
   │  업데이트 │            │            │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │
   │  + Select│            │            │             │             │
   │    Tool  │            │            │             │             │
   │    활성화│            │            │             │             │
   │           │            │            │             │             │
   ↓           ↓            ↓            ↓             ↓             ↓
```

---

## 4. 수동 Rectangle 슬라이싱

```
┌──────┐  ┌─────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │ Toolbar │  │SourcePanel│  │  Project │  │AtlasPreview│
└──┬───┘  └────┬────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │             │             │             │
   │ Rect Tool │             │             │             │
   │  클릭     │             │             │             │
   │──────────→│             │             │             │
   │           │ [Set Tool]  │             │             │
   │           │             │             │             │
   │  캔버스   │             │             │             │
   │  마우스   │             │             │             │
   │  Down     │             │             │             │
   │────────────────────────→│             │             │
   │           │             │             │             │
   │           │             │ [Start Pos] │             │
   │           │             │             │             │
   │  드래그   │             │             │             │
   │  (Move)   │             │             │             │
   │────────────────────────→│             │             │
   │           │             │             │             │
   │           │             │ [Draw Rect  │             │
   │           │             │  Preview]   │             │
   │           │             │             │             │
   │  점선     │             │             │             │
   │  사각형   │             │             │             │
   │  표시     │             │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │             │
   │           │             │             │             │
   │  마우스   │             │             │             │
   │  Up       │             │             │             │
   │────────────────────────→│             │             │
   │           │             │             │             │
   │           │             │ [End Pos]   │             │
   │           │             │             │             │
   │           │             │ [Calculate  │             │
   │           │             │  Rect]      │             │
   │           │             │             │             │
   │           │  createSprite(rect)       │             │
   │           │────────────────────────→  │             │
   │           │             │             │             │
   │           │             │  [Generate  │             │
   │           │             │   ID]       │             │
   │           │             │             │             │
   │           │             │  [Add to    │             │
   │           │             │   List]     │             │
   │           │             │             │             │
   │           │        success            │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │
   │           │             │             │             │
   │           │  triggerRepack()          │             │
   │           │────────────────────────────────────────→│
   │           │             │             │             │
   │  UI       │             │             │             │
   │  업데이트 │             │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │
   │           │             │             │             │
   ↓           ↓             ↓             ↓             ↓
```

---

## 5. 스프라이트 선택 및 속성 편집

```
┌──────┐  ┌───────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │SpriteList │  │Properties│  │SourcePanel│  │AtlasPreview│
└──┬───┘  └─────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │            │              │             │             │
   │  썸네일    │              │             │             │
   │  클릭      │              │             │             │
   │───────────→│              │             │             │
   │            │              │             │             │
   │            │ [Set Selected│             │             │
   │            │  Sprite]     │             │             │
   │            │              │             │             │
   │            │ updateProps(sprite)        │             │
   │            │─────────────→│             │             │
   │            │              │             │             │
   │            │              │ [Load Data] │             │
   │            │              │  - ID       │             │
   │            │              │  - Pos/Size │             │
   │            │              │  - Pivot    │             │
   │            │              │             │             │
   │  Properties│              │             │             │
   │  패널      │              │             │             │
   │  업데이트  │              │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │             │
   │            │              │             │             │
   │            │ highlightOnSource(sprite)  │             │
   │            │────────────────────────────→│             │
   │            │              │             │             │
   │            │              │  [Draw Blue │             │
   │            │              │   Border]   │             │
   │            │              │             │             │
   │  Source    │              │             │             │
   │  하이라이트│              │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │             │
   │            │              │             │             │
   │            │ highlightOnAtlas(sprite)   │             │
   │            │────────────────────────────────────────→ │
   │            │              │             │             │
   │            │              │             │  [Draw     │
   │            │              │             │   Thick    │
   │            │              │             │   Border]  │
   │            │              │             │             │
   │  Atlas     │              │             │             │
   │  하이라이트│              │             │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│
   │            │              │             │             │
   ↓            ↓              ↓             ↓             ↓
```

---

## 6. ID 편집 및 실시간 검증

```
┌──────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │Properties│  │Validation│  │  Project │
└──┬───┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │              │             │
   │ ID Field  │              │             │
   │ 입력 시작 │              │             │
   │──────────→│              │             │
   │           │              │             │
   │ "enemy_"  │              │             │
   │──────────→│ validate(id) │             │
   │           │─────────────→│             │
   │           │              │             │
   │           │              │ getAllIDs() │
   │           │              │────────────→│
   │           │              │             │
   │           │              │  List<ID>   │
   │           │              │◄─ ─ ─ ─ ─ ─│
   │           │              │             │
   │           │              │ [Check      │
   │           │              │  Duplicate] │
   │           │              │             │
   │           │    isValid   │             │
   │           │◄─ ─ ─ ─ ─ ─ ─│             │
   │           │              │             │
   │  녹색     │              │             │
   │  체크마크 │              │             │
   │◄─ ─ ─ ─ ─ │              │             │
   │           │              │             │
   │ "enemy_idle"             │             │
   │──────────→│ validate()   │             │
   │           │─────────────→│             │
   │           │              │             │
   │           │              │ getAllIDs() │
   │           │              │────────────→│
   │           │              │             │
   │           │              │  List<ID>   │
   │           │              │  contains   │
   │           │              │  "enemy_idle"│
   │           │              │◄─ ─ ─ ─ ─ ─│
   │           │              │             │
   │           │              │ [Duplicate! │
   │           │              │  Found]     │
   │           │              │             │
   │           │   isDuplicate│             │
   │           │◄─ ─ ─ ─ ─ ─ ─│             │
   │           │              │             │
   │  빨간     │              │             │
   │  경고     │              │             │
   │  아이콘   │              │             │
   │◄─ ─ ─ ─ ─ │              │             │
   │           │              │             │
   │  툴팁:    │              │             │
   │  "Duplicate              │             │
   │   ID"     │              │             │
   │◄─ ─ ─ ─ ─ │              │             │
   │           │              │             │
   │ "enemy_idle2"            │             │
   │──────────→│ validate()   │             │
   │           │─────────────→│             │
   │           │              │             │
   │           │    isValid   │             │
   │           │◄─ ─ ─ ─ ─ ─ ─│             │
   │           │              │             │
   │  녹색     │              │             │
   │  체크마크 │              │             │
   │◄─ ─ ─ ─ ─ │              │             │
   │           │              │             │
   │  Blur     │              │             │
   │──────────→│ updateID()   │             │
   │           │─────────────────────────→  │
   │           │              │             │
   │           │              │  [Save ID]  │
   │           │              │             │
   ↓           ↓              ↓             ↓
```

---

## 7. 피봇 설정 (MVP)

### 7.1 프리셋 선택

```
┌──────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │Properties│  │  Project │  │SourcePanel│
└──┬───┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │              │             │
   │ 3x3 Grid  │              │             │
   │ 버튼 클릭 │              │             │
   │ (예: BC)  │              │             │
   │──────────→│              │             │
   │           │              │             │
   │           │ [Create      │             │
   │           │  PivotPoint  │             │
   │           │  fromPreset] │             │
   │           │  x: 0.5      │             │
   │           │  y: 1.0      │             │
   │           │              │             │
   │           │ updatePivot(sprite, pivot) │
   │           │─────────────→│             │
   │           │              │             │
   │           │              │ [Update     │
   │           │              │  Sprite]    │
   │           │              │             │
   │           │        success             │
   │           │◄─ ─ ─ ─ ─ ─ ─│             │
   │           │              │             │
   │           │ updatePivotHandle(sprite)  │
   │           │────────────────────────────→│
   │           │              │             │
   │           │              │  [Calculate │
   │           │              │   Position] │
   │           │              │             │
   │           │              │  [Draw      │
   │           │              │   Handle ◉] │
   │           │              │             │
   │  피봇     │              │             │
   │  핸들     │              │             │
   │  위치     │              │             │
   │  업데이트 │              │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │
   │           │              │             │
   ↓           ↓              ↓             ↓
```

### 7.2 커스텀 피봇 드래그

```
┌──────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │SourcePanel│  │Properties│  │  Project │
└──┬───┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │              │             │
   │ 피봇 핸들 │              │             │
   │ 드래그    │              │             │
   │──────────→│              │             │
   │           │              │             │
   │           │ [Track Mouse │             │
   │           │  Position]   │             │
   │           │              │             │
   │  드래그   │              │             │
   │  중...    │              │             │
   │──────────→│              │             │
   │           │              │             │
   │           │ [Update      │             │
   │           │  Handle Pos] │             │
   │           │              │             │
   │  실시간   │              │             │
   │  핸들     │              │             │
   │  이동     │              │             │
   │◄─ ─ ─ ─ ─ │              │             │
   │           │              │             │
   │  마우스   │              │             │
   │  Up       │              │             │
   │──────────→│              │             │
   │           │              │             │
   │           │ [Calculate   │             │
   │           │  Normalized  │             │
   │           │  X, Y]       │             │
   │           │              │             │
   │           │ updateCustomPivot(x, y)    │
   │           │─────────────→│             │
   │           │              │             │
   │           │              │ updatePivot()│
   │           │              │────────────→│
   │           │              │             │
   │  Custom   │              │             │
   │  X/Y      │              │             │
   │  필드     │              │             │
   │  업데이트 │              │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │             │
   │           │              │             │
   ↓           ↓              ↓             ↓
```

---

## 8. 아틀라스 내보내기

```
┌──────┐  ┌─────────┐  ┌────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │ Toolbar │  │ Dialog │  │Validation│  │BinPacker │  │  Export  │
└──┬───┘  └────┬────┘  └───┬────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │            │            │             │             │
   │ Export    │            │            │             │             │
   │  버튼     │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │            │            │             │             │
   │           │ validateIDs()           │             │             │
   │           │────────────────────────→│             │             │
   │           │            │            │             │             │
   │           │            │  [Check    │             │             │
   │           │            │   Duplicates]            │             │
   │           │            │            │             │             │
   │           │      hasDuplicates      │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │             │
   │           │            │            │             │             │
   │  에러     │            │            │             │             │
   │  다이얼로그│            │            │             │             │
   │◄─ ─ ─ ─ ─ │            │            │             │             │
   │  "중복 ID │            │            │             │             │
   │   수정"   │            │            │             │             │
   │           │            │            │             │             │
   X──────────────────────── 중단 ────────────────────────────────────X
   │           │            │            │             │             │
   │  (수정 후 다시 Export)  │            │             │             │
   │           │            │            │             │             │
   │ Export    │            │            │             │             │
   │──────────→│ validateIDs()           │             │             │
   │           │────────────────────────→│             │             │
   │           │            │            │             │             │
   │           │       allValid          │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │             │
   │           │            │            │             │             │
   │           │ showDialog │            │             │             │
   │           │───────────→│            │             │             │
   │           │            │            │             │             │
   │  설정     │            │            │             │             │
   │  입력     │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │            │            │             │             │
   │  Export   │            │            │             │             │
   │  클릭     │            │            │             │             │
   │──────────→│            │            │             │             │
   │           │ getSettings│            │             │             │
   │           │───────────→│            │             │             │
   │           │  settings  │            │             │             │
   │           │◄─ ─ ─ ─ ─ ─│            │             │             │
   │           │            │            │             │             │
   │           │ pack(sprites, settings) │             │             │
   │           │────────────────────────────────────→  │             │
   │           │            │            │             │             │
   │           │            │            │  [MaxRects  │             │
   │           │            │            │   BSSF]     │             │
   │           │            │            │             │             │
   │           │            │            │  [Place All │             │
   │           │            │            │   Sprites]  │             │
   │           │            │            │             │             │
   │           │      PackingResult      │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │
   │           │            │            │             │             │
   │           │ export(result, settings)│             │             │
   │           │────────────────────────────────────────────────────→│
   │           │            │            │             │             │
   │           │            │            │             │  [Render    │
   │           │            │            │             │   Atlas     │
   │           │            │            │             │   Image]    │
   │           │            │            │             │             │
   │           │            │            │             │  [Generate  │
   │           │            │            │             │   JSON      │
   │           │            │            │             │   Metadata] │
   │           │            │            │             │             │
   │           │            │            │             │  [Save PNG] │
   │           │            │            │             │             │
   │           │            │            │             │  [Save JSON]│
   │           │            │            │             │             │
   │           │         success         │             │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │
   │           │            │            │             │             │
   │  성공     │            │            │             │             │
   │  메시지   │            │            │             │             │
   │◄─ ─ ─ ─ ─ │            │            │             │             │
   │  "Export  │            │            │             │             │
   │   Complete"            │            │             │             │
   │           │            │            │             │             │
   ↓           ↓            ↓            ↓             ↓             ↓
```

---

## 9. 프로젝트 저장/로드

### 9.1 프로젝트 저장

```
┌──────┐  ┌─────────┐  ┌──────────┐  ┌──────────┐
│ User │  │   Menu  │  │ Project  │  │FileUtils │
└──┬───┘  └────┬────┘  └────┬─────┘  └────┬─────┘
   │           │             │             │
   │ Cmd+S     │             │             │
   │──────────→│             │             │
   │           │             │             │
   │           │ [Check      │             │
   │           │  Saved Path]│             │
   │           │             │             │
   │           │ save()      │             │
   │           │────────────→│             │
   │           │             │             │
   │           │             │ [Serialize  │
   │           │             │  Project]   │
   │           │             │  - Settings │
   │           │             │  - Sources  │
   │           │             │  - Sprites  │
   │           │             │  - Anims    │
   │           │             │             │
   │           │             │ [Create JSON]│
   │           │             │             │
   │           │             │ writeFile() │
   │           │             │────────────→│
   │           │             │             │
   │           │             │             │ [Write .atlas]
   │           │             │             │
   │           │             │   success   │
   │           │             │◄─ ─ ─ ─ ─ ─│
   │           │             │             │
   │           │    success  │             │
   │           │◄─ ─ ─ ─ ─ ─ │             │
   │           │             │             │
   │  Status:  │             │             │
   │  "저장됨" │             │             │
   │◄─ ─ ─ ─ ─ │             │             │
   │           │             │             │
   ↓           ↓             ↓             ↓
```

### 9.2 프로젝트 로드

```
┌──────┐  ┌─────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐
│ User │  │   Menu  │  │ Project  │  │FileUtils │  │ImageUtils│
└──┬───┘  └────┬────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘
   │           │             │             │             │
   │ Open      │             │             │             │
   │ Project   │             │             │             │
   │──────────→│             │             │             │
   │           │             │             │             │
   │  파일 선택│             │             │             │
   │◄─ ─ ─ ─ ─ │             │             │             │
   │──────────→│             │             │             │
   │           │ load(path)  │             │             │
   │           │────────────→│             │             │
   │           │             │             │             │
   │           │             │ readFile()  │             │
   │           │             │────────────→│             │
   │           │             │             │             │
   │           │             │  JSON Data  │             │
   │           │             │◄─ ─ ─ ─ ─ ─│             │
   │           │             │             │             │
   │           │             │ [Parse JSON]│             │
   │           │             │             │             │
   │           │             │ [Validate   │             │
   │           │             │  Version]   │             │
   │           │             │             │             │
   │           │             │ [Check      │             │
   │           │             │  Source     │             │
   │           │             │  Paths]     │             │
   │           │             │             │             │
   │           │             │ loadImages()│             │
   │           │             │─────────────────────────→ │
   │           │             │             │             │
   │           │             │             │  [Load PNGs]│
   │           │             │             │             │
   │           │             │        ui.Image           │
   │           │             │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│
   │           │             │             │             │
   │           │             │ [Restore    │             │
   │           │             │  Sprites]   │             │
   │           │             │             │             │
   │           │             │ [Restore    │             │
   │           │             │  State]     │             │
   │           │             │             │             │
   │           │    success  │             │             │
   │           │◄─ ─ ─ ─ ─ ─ │             │             │
   │           │             │             │             │
   │  UI       │             │             │             │
   │  전체     │             │             │             │
   │  복원     │             │             │             │
   │◄─ ─ ─ ─ ─ │             │             │             │
   │           │             │             │             │
   ↓           ↓             ↓             ↓             ↓
```

---

## 10. 애니메이션 시퀀스 편집 (Phase 3)

```
┌──────┐  ┌──────────┐  ┌────────┐  ┌──────────┐  ┌──────────┐
│ User │  │AnimPanel │  │ Dialog │  │  Project │  │ Preview  │
└──┬───┘  └────┬─────┘  └───┬────┘  └────┬─────┘  └────┬─────┘
   │           │             │            │             │
   │ [+New]    │             │            │             │
   │  클릭     │             │            │             │
   │──────────→│             │            │             │
   │           │ showDialog  │            │             │
   │           │────────────→│            │             │
   │           │             │            │             │
   │  시퀀스   │             │            │             │
   │  이름 입력│             │            │             │
   │──────────→│             │            │             │
   │           │             │            │             │
   │  Sprite   │             │            │             │
   │  드래그&  │             │            │             │
   │  드롭     │             │            │             │
   │──────────→│             │            │             │
   │           │             │            │             │
   │           │             │ [Add Frame │             │
   │           │             │  to        │             │
   │           │             │  Timeline] │             │
   │           │             │            │             │
   │  Duration │             │            │             │
   │  슬라이더 │             │            │             │
   │  조절     │             │            │             │
   │──────────→│             │            │             │
   │           │             │            │             │
   │           │             │ [Update    │             │
   │           │             │  Frame     │             │
   │           │             │  Duration] │             │
   │           │             │            │             │
   │  [▶ Play  │             │            │             │
   │   Preview]│             │            │             │
   │──────────→│             │            │             │
   │           │             │            │             │
   │           │             │ playAnimation()          │
   │           │             │─────────────────────────→│
   │           │             │            │             │
   │           │             │            │  [Frame Loop│
   │           │             │            │   with      │
   │           │             │            │   Timing]   │
   │           │             │            │             │
   │  애니메이션│            │            │             │
   │  재생     │             │            │             │
   │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│
   │           │             │            │             │
   │  Loop/    │             │            │             │
   │  PingPong │             │            │             │
   │  설정     │             │            │             │
   │──────────→│             │            │             │
   │           │             │            │             │
   │  [Save]   │             │            │             │
   │──────────→│             │            │             │
   │           │  getSequence│            │             │
   │           │────────────→│            │             │
   │           │  sequence   │            │             │
   │           │◄─ ─ ─ ─ ─ ─ │            │             │
   │           │             │            │             │
   │           │ addAnimation(sequence)   │             │
   │           │─────────────────────────→│             │
   │           │             │            │             │
   │           │             │ [Save to   │             │
   │           │             │  Project]  │             │
   │           │             │            │             │
   │           │        success           │             │
   │           │◄─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│             │
   │           │             │            │             │
   │  Animation│             │            │             │
   │  Panel    │             │            │             │
   │  업데이트 │             │            │             │
   │◄─ ─ ─ ─ ─ │             │            │             │
   │           │             │            │             │
   ↓           ↓             ↓            ↓             ↓
```

---

## 11. 시퀀스 다이어그램 개선 포인트 요약

### 11.1 자동화된 흐름

| 인터랙션 | 자동 트리거 |
|---------|-----------|
| 슬라이싱 완료 | Atlas Preview 자동 재패킹 |
| Auto Slice 완료 | Select Tool 자동 활성화 ⭐ 개선! |
| 스프라이트 선택 | Source + Atlas + Properties 동시 업데이트 ⭐ 개선! |
| ID 입력 | 실시간 검증 ⭐ 개선! |

### 11.2 실시간 피드백

| 작업 | 피드백 시점 | 표시 방법 |
|------|-----------|----------|
| ID 중복 검증 | 입력 중 (실시간) | 빨간 경고 아이콘 + 툴팁 |
| 피봇 드래그 | 드래그 중 | 핸들 위치 실시간 업데이트 |
| Rectangle 드래그 | 드래그 중 | 점선 사각형 프리뷰 |
| 빈 패킹 실패 | Export 전 | 에러 다이얼로그 + 해결 제안 |

### 11.3 검증 단계

| 작업 | 검증 시점 | 검증 내용 |
|------|----------|----------|
| 이미지 로드 | 로드 직후 | PNG 포맷, 파일 유효성 |
| ID 편집 | 입력 중 | 중복 검증, 빈 값 검증 |
| Export | Export 전 | ID 중복 최종 검증 |
| 프로젝트 로드 | 로드 직후 | 버전 호환성, 소스 파일 존재 |

---

*Generated by UX Architect - 2025-12-22*
