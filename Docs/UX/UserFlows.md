# User Flows - CosmicAtlasPacker

> 텍스처 패킹 에디터의 주요 사용자 워크플로우
> **Last Updated**: 2025-12-22

---

## 1. 전체 워크플로우 개요

```
╔═══════════════╗
║  앱 실행      ║
╚═══════════════╝
       │
       ↓
┌───────────────┐
│ 빈 에디터     │
│ 화면 표시     │
└───────────────┘
       │
       ↓
    <신규 or>
    <기존?>
       │
       ├─────────→ 기존  ┌───────────────┐
       │                 │ 프로젝트 로드  │
       │                 └───────────────┘
       │                        │
       ↓ 신규                   │
┌───────────────┐               │
│ 소스 이미지    │←──────────────┘
│ 임포트        │
└───────────────┘
       │
       ↓
┌───────────────┐
│ 슬라이싱 작업  │ ◄─────┐
└───────────────┘        │
       │                 │
       ↓                 │
┌───────────────┐        │
│ 스프라이트     │        │
│ 속성 편집     │        │
└───────────────┘        │
       │                 │
       ↓                 │
   <더 편집?>            │
       │                 │
       ├─────────→ Yes ──┘
       │
       ↓ No
┌───────────────┐
│ 프로젝트 저장  │ (선택)
└───────────────┘
       │
       ↓
┌───────────────┐
│ 아틀라스      │
│ 내보내기      │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ PNG + JSON    ║
║ 출력 완료     ║
╚═══════════════╝
```

---

## 2. Flow 1: 프로젝트 시작

### 2.1 새 프로젝트 시작

```
╔═══════════════╗
║  앱 실행      ║
╚═══════════════╝
       │
       ↓
┌───────────────┐
│ 빈 에디터     │
│ 화면 표시     │
└───────────────┘
       │
       ↓
  ((사용자))
  File Menu →
  Import Source
  Image...
       │
       ↓
┌───────────────┐
│ 파일 선택     │
│ 다이얼로그    │
└───────────────┘
       │
       ↓
   <PNG?>
       │
       ├─────────→ No ──→ [에러 메시지] ──→ 다시 선택
       │
       ↓ Yes
[이미지 로드]
       │
       ↓
┌───────────────┐
│ Source Panel  │
│ 이미지 표시   │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ 슬라이싱 준비  ║
║ 완료          ║
╚═══════════════╝
```

### 2.2 기존 프로젝트 열기

```
╔═══════════════╗
║  앱 실행      ║
╚═══════════════╝
       │
       ↓
  ((사용자))
  File Menu →
  Open Project
       │
       ↓
┌───────────────┐
│ 파일 선택     │
│ (.atlas)      │
└───────────────┘
       │
       ↓
  <유효한?>
  <파일?>
       │
       ├─────────→ No ──→ [에러 메시지] ──→ 다시 선택
       │
       ↓ Yes
[프로젝트 로드]
       │
       ↓
[소스 이미지]
[복원]
       │
       ↓
[스프라이트]
[목록 복원]
       │
       ↓
╔═══════════════╗
║ 프로젝트      ║
║ 복원 완료     ║
╚═══════════════╝
```

---

## 3. Flow 2: 슬라이싱 워크플로우

### 3.1 수동 슬라이싱

```
┌───────────────┐
│ Source Panel  │
│ 이미지 표시   │
└───────────────┘
       │
       ↓
  ((사용자))
  Toolbar →
  Select Tool /
  Rect Tool
       │
       ↓
┌───────────────┐
│ Source Canvas │
│ 활성화        │
└───────────────┘
       │
       ↓
  ((마우스))
  ((드래그))
       │
       ↓
[사각형 영역]
[그리기]
       │
       ↓
┌───────────────┐
│ Slice Overlay │
│ 표시          │
└───────────────┘
       │
       ↓
  ((마우스))
  ((릴리즈))
       │
       ↓
[새 스프라이트]
[생성]
  ID: sprite_N
       │
       ↓
┌───────────────┐
│ Sprite List   │
│ 업데이트      │
└───────────────┘
       │
       ↓
┌───────────────┐
│ Atlas Preview │
│ 자동 재패킹   │
└───────────────┘
       │
       ↓
   <더 추가?>
       │
       ├─────────→ Yes ──→ 다시 드래그
       │
       ↓ No
╔═══════════════╗
║ 수동 슬라이싱  ║
║ 완료          ║
╚═══════════════╝
```

### 3.2 그리드 슬라이싱

```
┌───────────────┐
│ Source Panel  │
│ 이미지 표시   │
└───────────────┘
       │
       ↓
  ((사용자))
  Toolbar →
  Grid Slice
       │
       ↓
┌───────────────┐
│ Grid Slice    │
│ Dialog 표시   │
└───────────────┘
       │
       ↓
  ((사용자))
  설정 입력:
  - Cell Size or
  - Cell Count
  - Offset
       │
       ↓
   <유효한?>
   <값?>
       │
       ├─────────→ No ──→ [검증 에러] ──→ 다시 입력
       │
       ↓ Yes
  ((Apply))
  ((클릭))
       │
       ↓
[Grid Slicer]
[Service 실행]
       │
       ↓
[사각형 배열]
[생성]
       │
       ↓
[스프라이트]
[일괄 생성]
  ID: sprite_0,
      sprite_1...
       │
       ↓
┌───────────────┐
│ Sprite List   │
│ 업데이트      │
└───────────────┘
       │
       ↓
┌───────────────┐
│ Source Panel  │
│ 그리드 오버레이│
└───────────────┘
       │
       ↓
┌───────────────┐
│ Atlas Preview │
│ 자동 재패킹   │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ 그리드 슬라이싱║
║ 완료          ║
╚═══════════════╝
```

### 3.3 자동 슬라이싱 (투명도 기반) - MVP

```
┌───────────────┐
│ Source Panel  │
│ 이미지 표시   │
└───────────────┘
       │
       ↓
  ((사용자))
  Toolbar →
  Auto Slice
       │
       ↓
┌───────────────┐
│ Auto Slice    │
│ Dialog 표시   │
└───────────────┘
       │
       ↓
  ((사용자))
  설정 입력:
  - Alpha
    Threshold
  - Min Size
       │
       ↓
  ((Apply))
  ((클릭))
       │
       ↓
[Image Slicer]
[Service 실행]
       │
       ↓
[Flood Fill]
[알고리즘]
       │
       ↓
[투명도 기반]
[영역 감지]
       │
       ↓
[바운딩 박스]
[계산]
       │
       ↓
  <최소 크기?>
  <이상?>
       │
       ├─────────→ No ──→ 제외
       │
       ↓ Yes
[스프라이트]
[생성]
       │
       ↓
┌───────────────┐
│ Sprite List   │
│ 업데이트      │
└───────────────┘
       │
       ↓
┌───────────────┐
│ Source Panel  │
│ 감지 영역     │
│ 하이라이트    │
└───────────────┘
       │
       ↓
┌───────────────┐
│ Atlas Preview │
│ 자동 재패킹   │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ 자동 슬라이싱  ║
║ 완료          ║
╚═══════════════╝
```

---

## 4. Flow 3: 스프라이트 속성 편집

### 4.1 ID 편집 및 검증

```
┌───────────────┐
│ Sprite List   │
│ Panel         │
└───────────────┘
       │
       ↓
  ((사용자))
  ((스프라이트))
  ((클릭 선택))
       │
       ↓
┌───────────────┐
│ Properties    │
│ Panel 업데이트│
└───────────────┘
       │
       ↓
  ((사용자))
  ID TextField
  편집
       │
       ↓
[Validation]
[Service 실행]
       │
       ↓
  <중복 ID?>
       │
       ├─────────→ Yes ──→ ┌───────────────┐
       │                   │ 경고 인디케이터│
       │                   │ 표시 (빨강)   │
       │                   └───────────────┘
       │                          │
       │                          ↓
       │                    [내보내기 차단]
       │
       ↓ No
┌───────────────┐
│ 성공 인디케이터│
│ 표시 (녹색)   │
└───────────────┘
       │
       ↓
[스프라이트]
[데이터 업데이트]
       │
       ↓
┌───────────────┐
│ Sprite List   │
│ 라벨 업데이트 │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ ID 편집 완료  ║
╚═══════════════╝
```

### 4.2 피봇 설정 - MVP

```
┌───────────────┐
│ Properties    │
│ Panel         │
└───────────────┘
       │
       ↓
   <피봇?>
   <방법?>
       │
       ├─────────→ 프리셋 ──→ ┌───────────────┐
       │                      │ 3x3 Grid 버튼 │
       │                      │ 클릭          │
       │                      └───────────────┘
       │                             │
       │                             ↓
       │                      [PivotPoint]
       │                      [프리셋 생성]
       │                             │
       │                             ↓
       │                      ┌───────────────┐
       │                      │ X/Y 값 자동   │
       │                      │ 설정          │
       │                      └───────────────┘
       │                             │
       │                             └──────────┐
       │                                        │
       ↓ 커스텀                                 │
┌───────────────┐                               │
│ Custom X/Y    │                               │
│ TextField 입력│                               │
└───────────────┘                               │
       │                                        │
       ↓                                        │
  <0.0~1.0?>                                    │
  <범위?>                                       │
       │                                        │
       ├─────────→ No ──→ [검증 에러] ──→ 다시 │
       │                                        │
       ↓ Yes                                    │
       │                                        │
       └────────────────────────────────────────┤
                                                │
                                                ↓
                                         [스프라이트]
                                         [Pivot 업데이트]
                                                │
                                                ↓
                                         ┌───────────────┐
                                         │ Source Canvas │
                                         │ Pivot Handle  │
                                         │ 위치 업데이트 │
                                         └───────────────┘
                                                │
                                                ↓
                                         ╔═══════════════╗
                                         ║ 피봇 설정     ║
                                         ║ 완료          ║
                                         ╚═══════════════╝
```

### 4.3 9-Slice Border 설정 - Phase 3

```
┌───────────────┐
│ Properties    │
│ Panel         │
│ 9-Slice       │
│ Section       │
└───────────────┘
       │
       ↓
  ((사용자))
  L/R/T/B
  입력 (픽셀)
       │
       ↓
[스프라이트]
[NineSlice]
[업데이트]
       │
       ↓
  ((Preview))
  ((버튼 클릭))
       │
       ↓
┌───────────────┐
│ 9-Slice       │
│ Preview Dialog│
└───────────────┘
       │
       ↓
┌───────────────┐
│ 리사이즈      │
│ 시뮬레이션    │
│ 표시          │
└───────────────┘
       │
       ↓
  ((확인))
  ((Close))
       │
       ↓
╔═══════════════╗
║ 9-Slice 설정  ║
║ 완료          ║
╚═══════════════╝
```

---

## 5. Flow 4: 애니메이션 시퀀스 편집 - Phase 3

```
┌───────────────┐
│ Animation     │
│ Panel         │
└───────────────┘
       │
       ↓
  ((사용자))
  ((+ New))
  ((클릭))
       │
       ↓
┌───────────────┐
│ Animation     │
│ Editor Dialog │
└───────────────┘
       │
       ↓
  ((시퀀스 이름))
  ((입력))
       │
       ↓
  ((Sprite List))
  ((에서 드래그&))
  ((드롭))
       │
       ↓
┌───────────────┐
│ Frame         │
│ Timeline에    │
│ 추가          │
└───────────────┘
       │
       ↓
  ((Duration))
  ((슬라이더))
  ((조절))
       │
       ↓
  ((FlipX/FlipY))
  ((토글))
       │
       ↓
   <더 추가?>
       │
       ├─────────→ Yes ──→ 다시 드래그
       │
       ↓ No
  ((Loop/PingPong))
  ((설정))
       │
       ↓
  ((Preview))
  ((재생))
       │
       ↓
   <만족?>
       │
       ├─────────→ No ──→ 다시 편집
       │
       ↓ Yes
  ((Save))
  ((클릭))
       │
       ↓
[Animation]
[Sequence 생성]
       │
       ↓
┌───────────────┐
│ Animation     │
│ Panel 목록    │
│ 업데이트      │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ 애니메이션    ║
║ 생성 완료     ║
╚═══════════════╝
```

---

## 6. Flow 5: 아틀라스 내보내기

```
┌───────────────┐
│ 편집 완료된   │
│ 프로젝트      │
└───────────────┘
       │
       ↓
  ((사용자))
  Toolbar →
  Export 또는
  Menu → Export
       │
       ↓
[Validation]
[Service 실행]
       │
       ↓
  <ID 중복?>
       │
       ├─────────→ Yes ──→ ┌───────────────┐
       │                   │ 에러 다이얼로그│
       │                   │ "중복 ID 수정"│
       │                   └───────────────┘
       │                          │
       │                          ↓
       │                    [내보내기 취소]
       │
       ↓ No
┌───────────────┐
│ Export Dialog │
│ 표시          │
└───────────────┘
       │
       ↓
  ((Atlas 설정))
  입력:
  - Max Size
  - Padding
  - Extrude
  - Power of Two
       │
       ↓
  ((출력 경로))
  선택
       │
       ↓
  ((Export))
  ((클릭))
       │
       ↓
[Bin Packer]
[Service 실행]
       │
       ↓
  <패킹 성공?>
       │
       ├─────────→ No ──→ ┌───────────────┐
       │                  │ 에러 메시지:  │
       │                  │ "크기 초과"   │
       │                  └───────────────┘
       │                         │
       │                         ↓
       │                   [설정 다시 조정]
       │
       ↓ Yes
[아틀라스 이미지]
[렌더링]
       │
       ↓
[PNG 파일 저장]
       │
       ↓
[메타데이터 JSON]
[생성]
       │
       ↓
[JSON 파일 저장]
       │
       ↓
┌───────────────┐
│ 성공 메시지   │
│ 표시          │
└───────────────┘
       │
       ↓
╔═══════════════╗
║ PNG + JSON    ║
║ 출력 완료     ║
╚═══════════════╝
```

---

## 7. Flow 6: 프로젝트 저장/로드

### 7.1 프로젝트 저장

```
┌───────────────┐
│ 편집 중인     │
│ 프로젝트      │
└───────────────┘
       │
       ↓
  ((사용자))
  Cmd+S 또는
  Menu → Save
       │
       ↓
   <첫 저장?>
       │
       ├─────────→ Yes ──→ ┌───────────────┐
       │                   │ Save As Dialog│
       │                   │ 경로 선택     │
       │                   └───────────────┘
       │                          │
       │                          ↓
       │                   [파일명 입력]
       │                   (.atlas)
       │                          │
       │                          └──────────┐
       │                                     │
       ↓ No (기존 파일 있음)                 │
       │                                     │
       └─────────────────────────────────────┤
                                             │
                                             ↓
                                      [Project Service]
                                      [직렬화]
                                             │
                                             ↓
                                      [.atlas JSON]
                                      [파일 저장]
                                             │
                                             ↓
                                      ┌───────────────┐
                                      │ Status Bar    │
                                      │ "저장됨" 표시 │
                                      └───────────────┘
                                             │
                                             ↓
                                      ╔═══════════════╗
                                      ║ 프로젝트 저장 ║
                                      ║ 완료          ║
                                      ╚═══════════════╝
```

### 7.2 프로젝트 로드 (상세)

```
  ((사용자))
  Menu → Open
       │
       ↓
┌───────────────┐
│ 파일 선택     │
│ Dialog        │
└───────────────┘
       │
       ↓
  ((파일 선택))
  (.atlas)
       │
       ↓
[Project Service]
[파일 읽기]
       │
       ↓
  <유효한?>
  <JSON?>
       │
       ├─────────→ No ──→ [에러 메시지] ──→ 종료
       │
       ↓ Yes
[JSON 파싱]
       │
       ↓
  <버전 호환?>
       │
       ├─────────→ No ──→ [마이그레이션] ──→ 계속
       │
       ↓ Yes
[프로젝트 데이터]
[복원]
       │
       ↓
[소스 이미지]
[경로 확인]
       │
       ↓
  <파일 존재?>
       │
       ├─────────→ No ──→ ┌───────────────┐
       │                  │ 경고 메시지   │
       │                  │ "이미지 없음" │
       │                  └───────────────┘
       │                         │
       │                         ↓
       │                   [이미지 재선택]
       │                         │
       │                         └──────────┐
       ↓ Yes                                │
       │                                    │
       └────────────────────────────────────┤
                                            │
                                            ↓
                                     [이미지 로드]
                                            │
                                            ↓
                                     [스프라이트]
                                     [목록 복원]
                                            │
                                            ↓
                                     [Sprite List]
                                     [업데이트]
                                            │
                                            ↓
                                     [Atlas Preview]
                                     [재패킹]
                                            │
                                            ↓
                                     ╔═══════════════╗
                                     ║ 프로젝트 로드 ║
                                     ║ 완료          ║
                                     ╚═══════════════╝
```

---

## 8. Flow 7: 에러 핸들링 및 예외 처리

### 8.1 이미지 로드 실패

```
[파일 선택]
       │
       ↓
[이미지 로드]
[시도]
       │
       ↓
  <성공?>
       │
       ├─────────→ No ──→ <원인?>
       │                     │
       │                     ├─→ 포맷 불가 ──→ "PNG 파일만 지원" ──┐
       │                     │                                      │
       │                     ├─→ 파일 손상 ──→ "이미지 손상"       │
       │                     │                                      │
       │                     └─→ 메모리 부족 ──→ "파일 너무 큼"    │
       │                                                            │
       ↓ Yes                                                        │
       │                                                            │
       │              ┌─────────────────────────────────────────────┘
       │              │
       │              ↓
       │        ┌───────────────┐
       │        │ 에러 다이얼로그│
       │        │ 표시          │
       │        └───────────────┘
       │              │
       │              ↓
       │        [다시 시도] or [취소]
       │              │
       │              └──────────→ 종료 or 다시 선택
       │
       ↓
[정상 진행]
```

### 8.2 빈 패킹 실패

```
[Export 실행]
       │
       ↓
[Bin Packer]
[Service]
       │
       ↓
  <모든 스프라이트?>
  <배치 성공?>
       │
       ├─────────→ No ──→ ┌───────────────┐
       │                  │ 에러 다이얼로그│
       │                  │ "공간 부족"   │
       │                  │               │
       │                  │ 제안:         │
       │                  │ - 아틀라스    │
       │                  │   크기 증가   │
       │                  │ - Padding 감소│
       │                  └───────────────┘
       │                         │
       │                         ↓
       │                   ((사용자 선택))
       │                         │
       │                         ├─→ 설정 변경 ──→ [다시 Export]
       │                         │
       │                         └─→ 취소 ──→ [Export 중단]
       │
       ↓ Yes
[정상 진행]
```

---

## 9. 워크플로우 최적화 포인트

### 9.1 자동화된 흐름

| 트리거 | 자동 실행 |
|--------|----------|
| 슬라이싱 완료 | Atlas Preview 자동 재패킹 |
| 스프라이트 선택 | Properties Panel 자동 업데이트 |
| ID 편집 | 실시간 중복 검증 |
| 스프라이트 추가/삭제 | Sprite List 자동 업데이트 |

### 9.2 사용자 확인 필요 지점

| 작업 | 확인 시점 |
|------|----------|
| 프로젝트 덮어쓰기 | 저장 전 |
| 아틀라스 내보내기 | Export 전 (ID 중복 검증) |
| 대량 스프라이트 삭제 | 삭제 전 |
| 파일 닫기 (미저장 변경) | 닫기 전 |

### 9.3 되돌릴 수 없는 작업

| 작업 | 경고 메시지 |
|------|------------|
| 스프라이트 삭제 | "삭제된 스프라이트는 복구할 수 없습니다" (Phase 1-2) |
| 프로젝트 덮어쓰기 | "기존 파일이 덮어씌워집니다" |

**Phase 3 Undo/Redo 구현 시 경고 제거 가능**

---

## 10. 워크플로우 개선 사항 (ux-ui-specialist 분석 반영)

### 10.1 Auto Slice 후 자동 전환

**기존 문제**: Auto Slice 실행 후 수동으로 툴 전환 필요

**개선된 플로우**:
```
[Auto Slice 실행]
       │
       ↓
[스프라이트 생성]
       │
       ↓
[자동으로 Select Tool 활성화] ◄─── 개선!
       │
       ↓
[즉시 편집 가능 상태]
```

### 10.2 ID 검증 실시간 피드백

**기존 문제**: Export 시점에서야 중복 발견

**개선된 플로우**:
```
[ID TextField 입력]
       │
       ↓
[실시간 검증] ◄─── 개선!
       │
       ├─→ 중복 ──→ [빨간 인디케이터 + 툴팁]
       │
       └─→ 정상 ──→ [녹색 인디케이터]
```

### 10.3 Sprite List 선택 동기화

**개선된 플로우**:
```
[Sprite List 클릭]
       ↓
[Properties Panel 업데이트] ◄─── 기존
       +
[Source Panel에 Highlight] ◄─── 개선!
       +
[Atlas Preview에 Highlight] ◄─── 개선!
```

---

*Generated by UX Architect - 2025-12-22*
